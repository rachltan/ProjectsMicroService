<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Top Brands by Consumer Spending</title>
<style>
  body{
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    background:#f6f7fb;
    margin:0;
    padding:30px;
  }
  h1{font-size:28px;margin-bottom:16px;color:#2b2e43}
  table{
    width:100%;
    border-collapse:collapse;
    background:#fff;
    border-radius:10px;
    overflow:hidden;
    box-shadow:0 2px 10px rgba(0,0,0,.08);
  }
  th,td{
    padding:12px 16px;
    border-bottom:1px solid #e5e7eb;
    text-align:left;
  }
  th{background:#eef2ff;font-weight:600;color:#374151}
  tr:hover{background:#f9fafc}
  #errorMsg{
    margin-top:10px;
    font-size:14px;
    color:#b91c1c;
  }
</style>
</head>
<body>
  <h1>Top 10 Brands by Consumer Spending</h1>
  <table id="brandsTable">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Brand Name</th>
        <th>Sector</th>
        <th>Category</th>
        <th>State</th>
        <th>Spend ($)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <div id="errorMsg"></div>

<script>
async function loadTopBrands() {
  const res = await fetch('/api/top10companies');
  const data = await res.json();
  const tbody = document.querySelector('#brandsTable tbody');
  tbody.innerHTML = '';

  if (data.success && Array.isArray(data.data)) {
    data.data.forEach((item, i) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${i + 1}</td>
        <td>${item.brand_name || ''}</td>
        <td>${item.sector || ''}</td>
        <td>${item.category || ''}</td>
        <td>${item.state || ''}</td>
        <td>${item.spend_amount?.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}</td>
      `;
      tbody.appendChild(tr);
    });
  } else {
    tbody.innerHTML = `<tr><td colspan="6">No data available.</td></tr>`;
  }

  if (data.error_message) {
    document.getElementById('errorMsg').textContent = data.error_message;
  }
}
loadTopBrands();
</script>
</body>
</html>
